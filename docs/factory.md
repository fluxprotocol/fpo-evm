## Price feed factory

The price feed factory is deployed once and automatically handles the creation of individual price feeds and submitting values to them. It is recommended to deploy a factory contract for use with the [fpo-node](https://github.com/fluxprotocol/fpo-node) so that only one contract needs to be deployed rather than for each individual price feed.

The factory contract is [ERC-2362 compatible](https://github.com/tellor-io/EIP-2362) while the price feed contracts it generates are compatible with Chainlink's V2 and V3 aggregator interface.

### Deploy

Deploy a price feed factory (e.g. to Aurora):

```sh
$ npx hardhat deploy:FluxPriceFeedFactory --network aurora
```

Save the deployed contract address outputted by the command above.

Optionally include `--validator "0xMyAddress"` to grant a specific address the initial validator role rather than the deployer.

### Update answers

Using the mnemonic of the validator in the `.env` file, update multiple values on a deployed contract:

```sh
$ npx hardhat multiPriceFeedTransmit --contract 0xMyFactory --pricepairs "Price-ETH/USD-3 Price-BTC/USD-3" --answers "3000 37000" --network aurora
```

The format for the name of a price pair is "Price-`pair_name`-`decimals`".

### Fetch answer

```sh
$ npx hardhat multiPriceFeedValueFor --contract 0xMyFactory --pricepair "Price-ETH/USD-3" --network aurora
```

Additionally by using the contract address of an individual price feed generated by the factory (one may find this address by checking the factory's event logs after transmitting an answer for a new pair), one may query an individual price feed with the `latestAnswer` task described in the section below.
